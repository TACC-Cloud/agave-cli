.. _auth:


Initiating a session
####################

If you don't already have a session configuration saved somewhere, then you can
initiate a session as follows:

.. code-block:: console

    $ auth-session-init 
    ID                   NAME                                     URL 
    3dem                 3dem Tenant                              https://api.3dem.org/ 
    agave.prod           Agave Public Tenant                      https://public.agaveapi.co/
    araport.org          Araport                                  https://api.araport.org/  
    designsafe           DesignSafe                               https://agave.designsafe-ci.org/
    iplantc.org          CyVerse Science APIs                     https://agave.iplantc.org/  
    irec                 iReceptor                                https://irec.tenants.prod.tacc.cloud/
    portals              Portals Tenant                           https://portals-api.tacc.utexas.edu/ 
    sd2e                 SD2E Tenant                              https://api.sd2e.org/      
    sgci                 Science Gateways Community Institute     https://sgci.tacc.cloud/   
    tacc.prod            TACC                                     https://api.tacc.utexas.edu/  
    vdjserver.org        VDJ Server                               https://vdj-agave-api.tacc.utexas.edu/    
    
    Please specify the ID for the tenant you wish to interact with: sd2e
    Creating a client...
    API username: your-username
    API password: 
    Created client 31d15159d307 - Autogenerated client
    Getting oauth bearer tokens...
    API password:

You should now be ready to interact with the rest of TACC's services.
``auth-session-init`` will save your session configuration by default in
``~/.agave``, unless you specify another location using the ``-c, --cachedir``
flag.

You can also do this by specifying the tenant, username, and client flags:

.. code-block:: console

    $ auth-session-init -t tacc.prod -u user -N test-client -D "client for a tutorial"
    Client 'test-client' is not saved in ~/.agave, so we will create it...
    Creating a client...
    API password: 
    Created client test-client - client for a tutorial
    Getting oauth bearer tokens...
    API password:


Restoring a session
###################

If you have already have a ``config.json`` file created by
``auth-session-init`` then you can restore any of the sessions saved using the
same workflow.
For example, to restore the first session we created:

.. code-block:: console

    $ auth-session-init -t sd2e -u your-username -N client-name



Listing and deleting oauth clients
##################################

To find clients you have previously generated, you can use the ``clients-list``
command:

.. code-block:: console

    $ clients-list 
    API password:
    NAME                         DESCRIPTION
    agave-cli                    Sample description for Oauth client
    container                    test container
    testclient                   testing agavecli


If needed, you can delete an oauth client as such:

.. code-block:: console

    $ clients-delete testclient
    API password:
